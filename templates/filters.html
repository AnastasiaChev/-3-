{% extends "base.html" %}

{% block title %}üß≠ –§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–º–∞–º{% endblock %}

{% block content %}
    <div class="page-header">
        <h1>üß≠ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–µ–º–∞–º</h1>
        <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É, —á—Ç–æ–±—ã –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–Ω–∏–≥–∏</p>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Ç–µ–º–∞–º -->
    <div class="filter-panel">
        <h3>–¢–µ–º—ã:</h3>
        <div class="filter-buttons">
            <a href="{{ url_for('filter_books', topic='all') }}" class="filter-btn {% if current_topic == 'all' or not current_topic %}active{% endif %}">
                –í—Å–µ —Ç–µ–º—ã
            </a>
            {% for topic in topics %}
            <a href="{{ url_for('filter_books', topic=topic) }}" class="filter-btn {% if current_topic == topic %}active{% endif %}">
                {{ topic|title }}
            </a>
            {% endfor %}
        </div>
    </div>

    <div class="books-grid">
        {% for book in books %}
        <div class="book-card">
            <div class="book-cover">
                {% if book.cover %}
                    <img src="{{ url_for('static', filename='covers/' + book.cover) }}" alt="–û–±–ª–æ–∂–∫–∞ {{ book.filename }}">
                {% else %}
                    <img src="https://via.placeholder.com/120x180?text=üìñ+–ù–µ—Ç+–æ–±–ª–æ–∂–∫–∏" alt="–û–±–ª–æ–∂–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç">
                {% endif %}
            </div>
            <div class="book-info">
                <h3 class="book-title">
                    {{ book.metadata.title if book.metadata.title else book.filename.rsplit('.', 1)[0] }}
                </h3>
                {% if book.metadata.author %}
                <p class="book-author">–ê–≤—Ç–æ—Ä: {{ book.metadata.author }}</p>
                {% endif %}
                <a href="{{ url_for('download_file', filename=book.filename) }}" class="btn-download">
                    üì• –°–∫–∞—á–∞—Ç—å
                </a>
            </div>
        </div>
        {% else %}
        <p>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–Ω–∏–≥ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ñ–∏–ª—å—Ç—Ä—É.</p>
        {% endfor %}
    </div>

    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
    {% if total_pages > 1 %}
    <div class="pagination">
        {% if page > 1 %}
        <a href="{{ url_for('filter_books', page=page-1, topic=current_topic) }}" class="pagination-btn">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
        {% endif %}

        {% for p in pagination_range %}
        <a href="{{ url_for('filter_books', page=p, topic=current_topic) }}" class="pagination-btn {% if p == page %}active{% endif %}">{{ p }}</a>
        {% endfor %}

        {% if page < total_pages %}
        <a href="{{ url_for('filter_books', page=page+1, topic=current_topic) }}" class="pagination-btn">–°–ª–µ–¥—É—é—â–∞—è ‚Üí</a>
        {% endif %}
    </div>
    {% endif %}
{% endblock %}