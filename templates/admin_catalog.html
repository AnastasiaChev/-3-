{% extends "admin_base.html" %}

{% block title %}üîê –ê–¥–º–∏–Ω ‚Äî –ö–∞—Ç–∞–ª–æ–≥ —Ñ–∞–π–ª–æ–≤{% endblock %}

{% block admin_content %}
    <div class="page-header">
        <h1>üîê –ö–∞—Ç–∞–ª–æ–≥ —Ñ–∞–π–ª–æ–≤</h1>
        <p>–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–µ <code>books/</code></p>
    </div>

    <div class="search-panel">
        <form method="GET">
            <input type="text" name="q" value="{{ search_query }}" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞..." />
            <button type="submit">–ù–∞–π—Ç–∏</button>
            {% if search_query %}
            <a href="{{ url_for('admin_catalog') }}">–°–±—Ä–æ—Å–∏—Ç—å</a>
            {% endif %}
        </form>
    </div>

    <div class="admin-catalog">
        {% for item in catalog %}
        <div class="admin-file-card">
            <div class="file-info">
                <strong>{{ item.filename }}</strong><br>
                –†–∞–∑–º–µ—Ä: {{ item.size_mb }} –ú–ë<br>
                –ò–∑–º–µ–Ω—ë–Ω: {{ item.modified }}<br>
                –û–±–ª–æ–∂–∫–∞: {% if item.cover_exists %}‚úÖ –µ—Å—Ç—å{% else %}‚ùå –Ω–µ—Ç{% endif %}<br>
                –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ: {% if item.has_metadata %}‚úÖ –µ—Å—Ç—å ({{ item.metadata.topic or '–±–µ–∑ —Ç–µ–º—ã' }}){% else %}‚ùå –Ω–µ—Ç{% endif %}
            </div>
        </div>
        {% else %}
        <p>–§–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>
        {% endfor %}
    </div>

    {% if total_pages > 1 %}
    <div class="pagination">
        {% if page > 1 %}
        <a href="{{ url_for('admin_catalog', page=page-1, q=search_query) }}" class="pagination-btn">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
        {% endif %}

        {% for p in pagination_range %}
        <a href="{{ url_for('admin_catalog', page=p, q=search_query) }}" class="pagination-btn {% if p == page %}active{% endif %}">{{ p }}</a>
        {% endfor %}

        {% if page < total_pages %}
        <a href="{{ url_for('admin_catalog', page=page+1, q=search_query) }}" class="pagination-btn">–°–ª–µ–¥—É—é—â–∞—è ‚Üí</a>
        {% endif %}
    </div>
    {% endif %}
{% endblock %}